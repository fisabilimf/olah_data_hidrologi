<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Curah Hujan Harian</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid black;
        }
        th, td {
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        input {
            width: 100%;
            box-sizing: border-box;
            padding: 5px;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
    <input type="file" id="fileInput" accept=".csv, .xlsx, .xls" />
    <button onclick="populateData()">Populate Data</button>

    <form method="post" action="/">

        <h2>DATA CURAH HUJAN HARIAN</h2>
        

        <p>Tahun : <input type="text" name="tahun" value="[Tahun]" /></p>
        
        <table>
            <tr>
                <th>NAMA STASIUN</th>
                <td><input type="text" name="nama_stasiun" value="[Nama Stasiun]" /></td>
                <th>Wilayah Sungai</th>
                <td><input type="text" name="wilayah_sungai" value="[Wilayah Sungai]" /></td>
                <th>Kode Database</th>
                <td><input type="text" name="kode_database" value="[Kode Database]" /></td>
            </tr>
            <tr>
                <th>Kode Stasiun</th>
                <td><input type="text" name="kode_stasiun" value="[Kode Stasiun]" /></td>
                <th>Kelurahan/Desa</th>
                <td><input type="text" name="kelurahan" value="[Kelurahan/Desa]" /></td>
                <th>Tahun Pendirian</th>
                <td><input type="text" name="tahun_pendirian" value="[Tahun Pendirian]" /></td>
            </tr>
            <tr>
                <th>Lintang Selatan</th>
                <td><input type="text" name="longitude" value="[Longitude]" /></td>
                <th>Kecamatan</th>
                <td><input type="text" name="kecamatan" value="[Kecamatan]" /></td>
                <th>Tipe Alat</th>
                <td><input type="text" name="tipe_alat" value="[Tipe Alat]" /></td>
            </tr>
            <tr>
                <th>Bujur Timur</th>
                <td><input type="text" name="latitude" value="[Latitude]" /></td>
                <th>Kab/Kota</th>
                <td><input type="text" name="kabupaten" value="[Kabupaten]" /></td>
                <th>Pengelola</th>
                <td><input type="text" name="pengelola" value="[Pengelola]" /></td>
            </tr>
            <tr>
                <th>Elevasi</th>
                <td><input type="text" name="elevation" value="[Elevation]" /></td>
                <td colspan="4"></td>
            </tr>
        </table>
        

    <br>

        <table>
            <tr>
                <th rowspan="2">Tanggal</th>
                <th colspan="12">Bulan</th>
            </tr>
            <tr>
                <th>1</th>
                <th>2</th>
                <th>3</th>
                <th>4</th>
                <th>5</th>
                <th>6</th>
                <th>7</th>
                <th>8</th>
                <th>9</th>
                <th>10</th>
                <th>11</th>
                <th>12</th>
            </tr>
            <!-- Rows for the days -->
            {% for day in range(1, 32) %}
            <tr>
                <td>{{ day }}</td>
                {% for month in range(1, 13) %}
                <td><input type="text" name="day{{ day }}_month{{ month }}" value="0" oninput="calculateTotals({{ month }})"></td>
                {% endfor %}
            </tr>
            {% endfor %}
        </table>

        <br>

        <table>
            <tr>
                <th>Total</th>
                {% for month in range(1, 13) %}
                <td><input type="text" id="total_month{{ month }}" name="total_month{{ month }}" value="0" readonly></td>
                {% endfor %}
            </tr>
            <tr>
                <th>Periode1</th>
                {% for month in range(1, 13) %}
                <td><input type="text" id="periode1_month{{ month }}" name="periode1_month{{ month }}" value="0" readonly></td>
                {% endfor %}
            </tr>
            <tr>
                <th>Periode2</th>
                {% for month in range(1, 13) %}
                <td><input type="text" id="periode2_month{{ month }}" name="periode2_month{{ month }}" value="0" readonly></td>
                {% endfor %}
            </tr>
            <tr>
                <th>Periode3</th>
                {% for month in range(1, 13) %}
                <td><input type="text" id="periode3_month{{ month }}" name="periode3_month{{ month }}" value="0" readonly></td>
                {% endfor %}
            </tr>
            <tr>
                <th>Maksimum</th>
                {% for month in range(1, 13) %}
                <td><input type="text" id="maksimum_month{{ month }}" name="maksimum_month{{ month }}" value="0" readonly></td>
                {% endfor %}
            </tr>
        </table>

        <br>

        <table>
            <tr>
                <th>Data Hujan</th>
                {% for month in range(1, 13) %}
                <td><input type="text" name="datahujan_month{{ month }}" value="0"></td>
                {% endfor %}
            </tr>
        </table>

        <br>

        <br><br>

        <table>
            <tr>
                <th>No</th>
                <th>Bulan</th>
                <th>Curah Hujan</th>
                <th>Sk*</th>
                <th>[Sk*]</th>
                <th>Dy<sup>2</sup></th>
                <th>Dy</th>
                <th>Sk**</th>
                <th>[Sk**]</th>
            </tr>
            {% set months = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'] %}
            {% for i in range(12) %}
            <tr>
                <td>{{ i + 1 }}</td>
                <td>{{ months[i] }}</td>
                <td><input type="text" id="curah_hujan_{{ i }}" name="curah_hujan_{{ i }}" value="0" readonly></td>
                <td><input type="text" name="sk_{{ i }}" id="sk_{{ i }}" value="0" readonly></td>
                <td><input type="text" name="sk_brackets_{{ i }}" id="sk_brackets_{{ i }}" value="0" readonly></td>
                <td><input type="text" name="dy2_{{ i }}" id="dy2_{{ i }}" value="0" readonly></td>
                <td><input type="text" name="dy_{{ i }}" id="dy_{{ i }}" value="0" readonly></td>
                <td><input type="text" name="sk_star_{{ i }}" value="0" readonly></td>
                <td><input type="text" name="sk_star_brackets_{{ i }}" value="0" readonly></td>
            </tr>
            {% endfor %}
            <tr>
                <td colspan="2">Rerata</td>
                <td><input type="text" name="rerata_curah_hujan" id="rerata_curah_hujan" value="0" readonly></td>
                <td colspan="1"></td>
                <td><input type="text" name="rerata_sk_brackets" id="rerata_sk_brackets" value="0" readonly></td>
                <td colspan="4"></td>
            </tr>
            <tr>
                <td colspan="2">Jumlah</td>
                <td><input type="text" name="jumlah_curah_hujan" id="jumlah_curah_hujan" value="0" readonly></td>
                <td colspan="2"></td>
                <td><input type="text" name="jumlah_dy2" value="0" readonly></td>
            </tr>
            <tr>
                <td colspan="2">Maks</td>
                <td><input type="text" name="maks_curah_hujan" id="maks_curah_hujan" value="0" readonly></td>
                <td colspan="4"></td>
                <td><input type="text" name="maks_sk" value="0" readonly></td>
                <td><input type="text" name="maks_sk_brackets" value="0" readonly></td>
            </tr>
            <tr>
                <td colspan="2">Min</td>
                <td><input type="text" name="min_curah_hujan" id="min_curah_hujan" value="0" readonly></td>
                <td colspan="4"></td>
                <td><input type="text" name="min_sk" value="0" readonly></td>
                <td><input type="text" name="min_sk_brackets" value="0" readonly></td>
            </tr>
        </table>
        
        <br><br>
        <h2>Hasil Analisis</h2>
        <table>
            <tr>
                <td>n</td>
                <td><input type="text" name="n_value" id="n_value" value="12"></td>
            </tr>
            <tr>
                <td>Sk**mak</td>
                <td><input type="text" name="sk_mak" value="0" readonly></td>
            </tr>
            <tr>
                <td>Sk**min</td>
                <td><input type="text" name="sk_min" value="0" readonly></td>
            </tr>
            <tr>
                <td>Q = Sk**mak</td>
                <td><input type="text" name="q_sk_mak" value="0" readonly></td>
            </tr>
            <tr>
                <td>R = Sk**mak - Sk**min</td>
                <td><input type="text" name="r_sk_diff" value="0" readonly></td>
            </tr>
            <tr>
                <td>Q/n<sup>0.5</sup></td>
                <td><input type="text" name="q_over_n" value="0" readonly></td>
                <td> dengan probabilitas <input type="text" name="q_p" id="q_p" value="95">% dari tabel</td>
                <td><input type="text" name="q_value" id="q_value" value="0" readonly></td>
                <td style="background-color: yellow;"><input type="text" style="background-color: yellow;" value="-" readonly></td>
            </tr>
            <tr>
                <td>R/n<sup>0.5</sup></td>
                <td><input type="text" name="r_over_n" value="0"></td>
                <td> dengan probabilitas <input type="text" name="r_p" id="r_p" value="95">% dari tabel</td>
                <td><input type="text" name="r_value" id="r_value" value="0" readonly></td>
                <td style="background-color: yellow;"><input type="text" style="background-color: yellow;" value="-" readonly></td>
            </tr>
        </table>

        <br><br>

        <div class="flex-item">
            <h2>Nilai Q/n<sup>0.5</sup> dan R/n<sup>0.5</sup></h2>
            <table>
                <tr>
                    <th rowspan="2">n</th>
                    <th colspan="3">Q/n<sup>0.5</sup></th>
                    <th colspan="3">R/n<sup>0.5</sup></th>
                </tr>
                <tr>
                    <th><input type="text" name="q" id="q" value="90%" readonly></th>
                    <th><input type="text" name="q" id="q" value="95%" readonly></th>
                    <th><input type="text" name="q" id="q" value="99%" readonly></th>
                    <th><input type="text" name="r" id="r" value="90%" readonly></th>
                    <th><input type="text" name="r" id="r" value="95%" readonly></th>
                    <th><input type="text" name="r" id="r" value="99%" readonly></th>
                </tr>                
                <tr>
                    <td><input type="text" name="n" id="n" value="10" readonly></td>
                    <td><input type="text" name="q_n" id="q_n" value="1.05" readonly></td>
                    <td><input type="text" name="q_n" id="q_n" value="1.14" readonly></td>
                    <td><input type="text" name="q_n" id="q_n" value="1.29" readonly></td>
                    <td><input type="text" name="r_n" id="r_n" value="1.21" readonly></td>
                    <td><input type="text" name="r_n" id="r_n" value="1.28" readonly></td>
                    <td><input type="text" name="r_n" id="r_n" value="1.38" readonly></td>
                </tr>
                <tr>
                    <td><input type="text" name="n" id="n" value="20" readonly></td>
                    <td><input type="text" name="q_n" id="q_n" value="1.10" readonly></td>
                    <td><input type="text" name="q_n" id="q_n" value="1.22" readonly></td>
                    <td><input type="text" name="q_n" id="q_n" value="1.42" readonly></td>
                    <td><input type="text" name="r_n" id="r_n" value="1.34" readonly></td>
                    <td><input type="text" name="r_n" id="r_n" value="1.43" readonly></td>
                    <td><input type="text" name="r_n" id="r_n" value="1.60" readonly></td>
                </tr>
                <tr>
                    <td><input type="text" name="n" id="n" value="30" readonly></td>
                    <td><input type="text" name="q_n" id="q_n" value="1.12" readonly></td>
                    <td><input type="text" name="q_n" id="q_n" value="1.24" readonly></td>
                    <td><input type="text" name="q_n" id="q_n" value="1.48" readonly></td>
                    <td><input type="text" name="r_n" id="r_n" value="1.40" readonly></td>
                    <td><input type="text" name="r_n" id="r_n" value="1.50" readonly></td>
                    <td><input type="text" name="r_n" id="r_n" value="1.70" readonly></td>
                </tr>
                <tr>
                    <td><input type="text" name="n" id="n" value="40" readonly></td>
                    <td><input type="text" name="q_n" id="q_n" value="1.14" readonly></td>
                    <td><input type="text" name="q_n" id="q_n" value="1.27" readonly></td>
                    <td><input type="text" name="q_n" id="q_n" value="1.52" readonly></td>
                    <td><input type="text" name="r_n" id="r_n" value="1.44" readonly></td>
                    <td><input type="text" name="r_n" id="r_n" value="1.55" readonly></td>
                    <td><input type="text" name="r_n" id="r_n" value="1.78" readonly></td>
                </tr>
                <tr>
                    <td><input type="text" name="n" id="n" value="100" readonly></td>
                    <td><input type="text" name="q_n" id="q_n" value="1.17" readonly></td>
                    <td><input type="text" name="q_n" id="q_n" value="1.29" readonly></td>
                    <td><input type="text" name="q_n" id="q_n" value="1.55" readonly></td>
                    <td><input type="text" name="r_n" id="r_n" value="1.62" readonly></td>
                    <td><input type="text" name="r_n" id="r_n" value="1.75" readonly></td>
                    <td><input type="text" name="r_n" id="r_n" value="2.00" readonly></td>
                </tr>
            </table>
            
            
            <p>Sumber: Sri Harto, 1993: 168</p>
        </div>

        
        <input type="submit" value="Submit">
    </form>
    
    <script>
        function calculateTotals(month) {
            let total = 0;
            let max = 0;
            let periode1 = 0;
            let periode2 = 0;
            let periode3 = 0;
            let nonZeroCount = 0;
    
            for (let day = 1; day <= 31; day++) {
                const input = document.querySelector(`input[name="day${day}_month${month}"]`);
                if (input && !isNaN(parseFloat(input.value))) {
                    const value = parseFloat(input.value) || 0;
                    total += value;
                    if (value > 0) {
                        nonZeroCount++;
                    }
                    if (value > max) {
                        max = value;
                    }
                    if (day <= 10) {
                        periode1 += value;
                    } else if (day <= 20) {
                        periode2 += value;
                    } else {
                        periode3 += value;
                    }
                }
            }
            document.getElementById(`total_month${month}`).value = total;
            document.getElementById(`maksimum_month${month}`).value = max;
            document.getElementById(`periode1_month${month}`).value = periode1;
            document.getElementById(`periode2_month${month}`).value = periode2;
            document.getElementById(`periode3_month${month}`).value = periode3;
    
            document.getElementById(`curah_hujan_${month - 1}`).value = total;
    
            document.getElementsByName(`datahujan_month${month}`)[0].value = nonZeroCount;
    
            calculateCurahHujanTotal();
        }
    
        function calculateCurahHujanTotal() {
            let jumlahCurahHujan = 0;
            let count = 0;
            let maxCurahHujan = 0;
            let minCurahHujan = Infinity;
    
            for (let i = 0; i < 12; i++) {
                const curahHujanValue = parseFloat(document.getElementById(`curah_hujan_${i}`).value) || 0;
                jumlahCurahHujan += curahHujanValue;
                if (curahHujanValue > 0) {
                    count++;
                }
                if (curahHujanValue > maxCurahHujan) {
                    maxCurahHujan = curahHujanValue;
                }
                if (curahHujanValue < minCurahHujan && curahHujanValue > 0) {
                    minCurahHujan = curahHujanValue;
                }
            }
    
            const rerataCurahHujan = count > 0 ? (jumlahCurahHujan / count).toFixed(2) : 0;
    
            if (minCurahHujan === Infinity) {
                minCurahHujan = 0;
            }
    
            document.getElementById('jumlah_curah_hujan').value = jumlahCurahHujan;
            document.getElementById('rerata_curah_hujan').value = rerataCurahHujan;
            document.getElementById('maks_curah_hujan').value = maxCurahHujan;
            document.getElementById('min_curah_hujan').value = minCurahHujan;
    
            calculateSk(rerataCurahHujan);
            calculateAllSkStars();
        }
    
        function calculateSk(rerata) {
            let totalSkBrackets = 0;
            let count = 0;
    
            for (let i = 0; i < 12; i++) {
                const curahHujanValue = parseFloat(document.getElementById(`curah_hujan_${i}`).value) || 0;
                const skValue = (curahHujanValue - rerata).toFixed(2);
                document.getElementById(`sk_${i}`).value = skValue;
    
                const skBracketsValue = Math.abs(skValue).toFixed(2);
                document.getElementById(`sk_brackets_${i}`).value = skBracketsValue;
    
                const nValue = parseFloat(document.getElementById('n_value').value) || 12;
                const dy2Value = ((skBracketsValue ** 2) / nValue).toFixed(2);
                document.getElementById(`dy2_${i}`).value = dy2Value;
    
                totalSkBrackets += parseFloat(skBracketsValue);
                count++;
            }
    
            const rerataSkBrackets = count > 0 ? (totalSkBrackets / count).toFixed(2) : 0;
            document.getElementById('rerata_sk_brackets').value = rerataSkBrackets;
    
            calculateDy2Sum();
        }
    
        function calculateSkStar(i) {
            const skBracketsValue = parseFloat(document.getElementById(`sk_brackets_${i}`).value) || 0;
            const dyValue = parseFloat(document.getElementById(`dy_${i}`).value) || 1;
    
            const skStarValue = (dyValue !== 0) ? (skBracketsValue / dyValue).toFixed(2) : 0;
            document.getElementsByName(`sk_star_${i}`)[0].value = skStarValue;
    
            const skStarBracketsValue = Math.abs(skStarValue).toFixed(2);
            document.getElementsByName(`sk_star_brackets_${i}`)[0].value = skStarBracketsValue;
        }
    
        function calculateAllSkStars() {
            for (let i = 0; i < 12; i++) {
                calculateSkStar(i);
            }
    
            calculateMaxMinSk();
            calculateMaxMinSkBrackets();
        }
    
        function calculateDy2Sum() {
            let sumDy2 = 0;
    
            for (let i = 0; i < 12; i++) {
                const dy2Value = parseFloat(document.getElementById(`dy2_${i}`).value) || 0;
                sumDy2 += dy2Value;
            }
    
            document.getElementsByName('jumlah_dy2')[0].value = sumDy2.toFixed(2);
    
            updateDyFields();
        }
    
        function updateDyFields() {
            const jumlahDy2Value = parseFloat(document.getElementsByName('jumlah_dy2')[0].value) || 0;
            const sqrtValue = Math.sqrt(jumlahDy2Value).toFixed(2);
    
            for (let i = 0; i < 12; i++) {
                document.getElementById(`dy_${i}`).value = sqrtValue;
            }
        }
    
        function calculateMaxMinSk() {
            let maxSk = -Infinity;
            let minSk = Infinity;
    
            for (let i = 0; i < 12; i++) {
                const skStarValue = parseFloat(document.getElementsByName(`sk_star_${i}`)[0].value) || 0;
    
                if (skStarValue > maxSk) {
                    maxSk = skStarValue;
                }
    
                if (skStarValue < minSk) {
                    minSk = skStarValue;
                }
            }
    
            document.getElementsByName('maks_sk')[0].value = maxSk.toFixed(2);
            document.getElementsByName('min_sk')[0].value = minSk.toFixed(2);
    
            setSkMak();
            setSkMin();
        }
    
        function calculateMaxMinSkBrackets() {
            let maxSkBrackets = -Infinity;
            let minSkBrackets = Infinity;
    
            for (let i = 0; i < 12; i++) {
                const skStarBracketsValue = parseFloat(document.getElementsByName(`sk_star_brackets_${i}`)[0].value) || 0;
    
                if (skStarBracketsValue > maxSkBrackets) {
                    maxSkBrackets = skStarBracketsValue;
                }
    
                if (skStarBracketsValue < minSkBrackets) {
                    minSkBrackets = skStarBracketsValue;
                }
            }
    
            document.getElementsByName('maks_sk_brackets')[0].value = maxSkBrackets.toFixed(2);
            document.getElementsByName('min_sk_brackets')[0].value = minSkBrackets.toFixed(2);
        }
    
        function setSkMak() {
            const maksSkValue = document.getElementsByName('maks_sk')[0].value;
            document.getElementsByName('sk_mak')[0].value = maksSkValue;
    
            setQSkMak();
            calculateRSkDiff();
        }
    
        function setSkMin() {
            const minSkValue = document.getElementsByName('min_sk')[0].value;
            document.getElementsByName('sk_min')[0].value = minSkValue;
    
            calculateRSkDiff();
        }
    
        function setQSkMak() {
            const skMakValue = document.getElementsByName('sk_mak')[0].value;
            document.getElementsByName('q_sk_mak')[0].value = skMakValue;
    
            calculateQOverN();
        }
    
        function calculateRSkDiff() {
            const skMakValue = parseFloat(document.getElementsByName('sk_mak')[0].value) || 0;
            const skMinValue = parseFloat(document.getElementsByName('sk_min')[0].value) || 0;
            const rSkDiffValue = (skMakValue - skMinValue).toFixed(2);
    
            document.getElementsByName('r_sk_diff')[0].value = rSkDiffValue;
    
            calculateROverN();
        }
    
        function calculateQOverN() {
            const qSkMakValue = parseFloat(document.getElementsByName('q_sk_mak')[0].value) || 0;
            const nValue = parseFloat(document.getElementById('n_value').value) || 1;
    
            const qOverNValue = (qSkMakValue / Math.sqrt(nValue)).toFixed(2);
            document.getElementsByName('q_over_n')[0].value = qOverNValue;
        }
    
        function calculateROverN() {
            const rSkDiffValue = parseFloat(document.getElementsByName('r_sk_diff')[0].value) || 0;
            const nValue = parseFloat(document.getElementById('n_value').value) || 1;
    
            const rOverNValue = (rSkDiffValue / Math.sqrt(nValue)).toFixed(2);
            document.getElementsByName('r_over_n')[0].value = rOverNValue;
        }
    
        function calculateValues() {
            const QTable = {
                10: { '90': 1.05, '95': 1.14, '99': 1.29 },
                20: { '90': 1.10, '95': 1.22, '99': 1.42 },
                30: { '90': 1.12, '95': 1.24, '99': 1.48 },
                40: { '90': 1.14, '95': 1.27, '99': 1.52 },
                100: { '90': 1.17, '95': 1.29, '99': 1.55 }
            };
    
            const RTable = {
                10: { '90': 1.21, '95': 1.28, '99': 1.38 },
                20: { '90': 1.34, '95': 1.43, '99': 1.60 },
                30: { '90': 1.40, '95': 1.50, '99': 1.70 },
                40: { '90': 1.44, '95': 1.55, '99': 1.78 },
                100: { '90': 1.50, '95': 1.62, '99': 1.85 }
            };
    
            function calculateQValue() {
                const n = parseInt(document.querySelector('input[name="q_over_n"]').value);
                const confidenceLevel = document.querySelector('input[name="q_p"]').value + '%';
    
                const qValue = QTable[n] && QTable[n][confidenceLevel] !== undefined 
                    ? QTable[n][confidenceLevel] 
                    : 'Invalid input';
                document.getElementById('q_value').value = qValue;
            }
    
            function calculateRValue() {
                const n = parseInt(document.querySelector('input[name="r_over_n"]').value);
                const confidenceLevel = document.querySelector('input[name="r_p"]').value + '%';
    
                const rValue = RTable[n] && RTable[n][confidenceLevel] !== undefined 
                    ? RTable[n][confidenceLevel] 
                    : 'Invalid input';
                document.getElementById('r_value').value = rValue;
            }
    
            document.querySelector('input[name="q_over_n"]').addEventListener('input', calculateQValue);
            document.querySelector('input[name="q_p"]').addEventListener('input', calculateQValue);
            document.querySelector('input[name="r_over_n"]').addEventListener('input', calculateRValue);
            document.querySelector('input[name="r_p"]').addEventListener('input', calculateRValue);
        }
    
        document.addEventListener('DOMContentLoaded', calculateValues);
    </script>    

    <script>
        let excelData = {};

        document.getElementById('fileInput').addEventListener('change', handleFileSelect, false);

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    const data = e.target.result;
                    const workbook = XLSX.read(data, { type: 'binary' });
                    const firstSheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[firstSheetName];
                    excelData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                    console.log(excelData);
                };
                reader.readAsBinaryString(file);
            }
        }

        function populateData() {
            if (!excelData || excelData.length === 0) {
                alert("Please upload and select a file first.");
                return;
            }

            // Assuming the data you want starts at row 2 (row 1 being headers)
            document.querySelector('input[name="tahun"]').value = excelData[1][0].toString().match(/\d+/)?.[0] || '';
            document.querySelector('input[name="nama_stasiun"]').value = excelData[3][2];
            document.querySelector('input[name="kode_stasiun"]').value = excelData[4][2];
            document.querySelector('input[name="longitude"]').value = excelData[5][2];
            document.querySelector('input[name="latitude"]').value = excelData[6][2];
            document.querySelector('input[name="elevation"]').value = excelData[7][2];
            document.querySelector('input[name="wilayah_sungai"]').value = excelData[4][7];
            document.querySelector('input[name="kelurahan"]').value = excelData[5][7];
            document.querySelector('input[name="kecamatan"]').value = excelData[6][7];
            document.querySelector('input[name="kabupaten"]').value = excelData[7][7];
            document.querySelector('input[name="kode_database"]').value = excelData[4][11];
            document.querySelector('input[name="tahun_pendirian"]').value = excelData[5][11];
            document.querySelector('input[name="tipe_alat"]').value = excelData[6][11];
            document.querySelector('input[name="pengelola"]').value = excelData[7][11];

            // Loop to populate the daily data
            for (let day = 1; day <= 31; day++) {
                for (let month = 1; month <= 12; month++) {
                    const value = excelData[day + 10][month];
                    document.querySelector(`input[name="day${day}_month${month}"]`).value = value || 0;
                }
            }
        }
    </script>
    
</body>
</html>
