<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Curah Hujan Harian</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        table, th, td {
            border: 1px solid black;
        }
        th, td {
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        input {
            width: 100%;
            box-sizing: border-box;
            padding: 5px;
        }
    </style>
</head>
<body>

    <h2>DATA CURAH HUJAN HARIAN</h2>
    <p>Tahun : [Tahun]</p>

    <table>
        <tr>
            <th>NAMA STASIUN</th>
            <td>[Nama Stasiun]</td>
            <th>Wilayah Sungai</th>
            <td>[Wilayah Sungai]</td>
            <th>Kode Database</th>
            <td>[Kode Database]</td>
        </tr>
        <tr>
            <th>Kode Stasiun</th>
            <td>[Kode Stasiun]</td>
            <th>Kelurahan/Desa</th>
            <td>[Kelurahan/Desa]</td>
            <th>Tahun Pendirian</th>
            <td>[Tahun Pendirian]</td>
        </tr>
        <tr>
            <th>Lintang Selatan</th>
            <td>[Longitude]</td>
            <th>Kecamatan</th>
            <td>[Kecamatan]</td>
            <th>Tipe Alat</th>
            <td>[Tipe Alat]</td>
        </tr>
        <tr>
            <th>Bujur Timur</th>
            <td>[Latitude]</td>
            <th>Kab/Kota</th>
            <td>[Kabupaten]</td>
            <th>Pengelola</th>
            <td>[Pengelola]</td>
        </tr>
        <tr>
            <th>Elevasi</th>
            <td>[Elevation]</td>
            <td colspan="4"></td>
        </tr>
    </table>

    <br>

    <form method="post" action="/">
        <table>
            <tr>
                <th rowspan="2">Tanggal</th>
                <th colspan="12">Bulan</th>
            </tr>
            <tr>
                <th>1</th>
                <th>2</th>
                <th>3</th>
                <th>4</th>
                <th>5</th>
                <th>6</th>
                <th>7</th>
                <th>8</th>
                <th>9</th>
                <th>10</th>
                <th>11</th>
                <th>12</th>
            </tr>
            <!-- Rows for the days -->
            {% for day in range(1, 32) %}
            <tr>
                <td>{{ day }}</td>
                {% for month in range(1, 13) %}
                <td><input type="text" name="day{{ day }}_month{{ month }}" value="" oninput="calculateTotals({{ month }})"></td>
                {% endfor %}
            </tr>
            {% endfor %}
        </table>

        <br>

        <table>
            <tr>
                <th>Total</th>
                {% for month in range(1, 13) %}
                <td><input type="text" id="total_month{{ month }}" name="total_month{{ month }}" value="" readonly></td>
                {% endfor %}
            </tr>
            <tr>
                <th>Periode1</th>
                {% for month in range(1, 13) %}
                <td><input type="text" id="periode1_month{{ month }}" name="periode1_month{{ month }}" value="" readonly></td>
                {% endfor %}
            </tr>
            <tr>
                <th>Periode2</th>
                {% for month in range(1, 13) %}
                <td><input type="text" id="periode2_month{{ month }}" name="periode2_month{{ month }}" value="" readonly></td>
                {% endfor %}
            </tr>
            <tr>
                <th>Periode3</th>
                {% for month in range(1, 13) %}
                <td><input type="text" id="periode3_month{{ month }}" name="periode3_month{{ month }}" value="" readonly></td>
                {% endfor %}
            </tr>
            <tr>
                <th>Maksimum</th>
                {% for month in range(1, 13) %}
                <td><input type="text" id="maksimum_month{{ month }}" name="maksimum_month{{ month }}" value="" readonly></td>
                {% endfor %}
            </tr>
        </table>

        <br>

        <table>
            <tr>
                <th>Data Hujan</th>
                {% for month in range(1, 13) %}
                <td><input type="text" name="datahujan_month{{ month }}" value="[JAM HUJAN]"></td>
                {% endfor %}
            </tr>
        </table>

        <br>

        <input type="submit" value="Submit">
    </form>

    <br><br>

    <form method="post" action="/">
        <table>
            <tr>
                <th>No</th>
                <th>Bulan</th>
                <th>Curah Hujan</th>
                <th>Sk*</th>
                <th>[Sk*]</th>
                <th>Dy<sup>2</sup></th>
                <th>Dy</th>
                <th>Sk**</th>
                <th>[Sk**]</th>
            </tr>
            {% set months = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'] %}
            {% for i in range(12) %}
            <tr>
                <td>{{ i + 1 }}</td>
                <td>{{ months[i] }}</td>
                <td><input type="text" id="curah_hujan_{{ i }}" name="curah_hujan_{{ i }}" value="" readonly></td>
                <td><input type="text" name="sk_{{ i }}" id="sk_{{ i }}" value="" readonly></td>
                <td><input type="text" name="sk_brackets_{{ i }}" id="sk_brackets_{{ i }}" value="" readonly></td>
                <td><input type="text" name="dy2_{{ i }}" id="dy2_{{ i }}" value="" readonly></td>
                <td><input type="text" name="dy_{{ i }}" value=""></td>
                <td><input type="text" name="sk_star_{{ i }}" value=""></td>
                <td><input type="text" name="sk_star_brackets_{{ i }}" value=""></td>
            </tr>
            {% endfor %}
            <tr>
                <td colspan="2">Rerata</td>
                <td><input type="text" name="rerata_curah_hujan" id="rerata_curah_hujan" value="" readonly></td>
                <td colspan="1"></td>
                <td><input type="text" name="rerata_sk_brackets" id="rerata_sk_brackets" value="" readonly></td>
                <td colspan="4"></td>
            </tr>
            <tr>
                <td colspan="2">Jumlah</td>
                <td><input type="text" name="jumlah_curah_hujan" id="jumlah_curah_hujan" value="" readonly></td>
                <td colspan="2"></td>
                <td><input type="text" name="jumlah_dy2" value=""></td>
            </tr>
            <tr>
                <td colspan="2">Maks</td>
                <td><input type="text" name="maks_curah_hujan" id="maks_curah_hujan" value="" readonly></td>
                <td colspan="4"></td>
                <td><input type="text" name="maks_sk" value=""></td>
                <td><input type="text" name="maks_sk_brackets" value=""></td>
            </tr>
            <tr>
                <td colspan="2">Min</td>
                <td><input type="text" name="min_curah_hujan" id="min_curah_hujan" value="" readonly></td>
                <td colspan="4"></td>
                <td><input type="text" name="min_sk" value=""></td>
                <td><input type="text" name="min_sk_brackets" value=""></td>
            </tr>
        </table>
        
        <br><br>
        <h2>Hasil Analisis</h2>
        <table>
            <tr>
                <td>n</td>
                <td><input type="text" name="n" id="n" value="12"></td>
            </tr>
            <tr>
                <td>Sk**mak</td>
                <td><input type="text" name="sk_mak" value=""></td>
            </tr>
            <tr>
                <td>Sk**min</td>
                <td><input type="text" name="sk_min" value=""></td>
            </tr>
            <tr>
                <td>Q = Sk**mak</td>
                <td><input type="text" name="q_sk_mak" value=""></td>
            </tr>
            <tr>
                <td>R = Sk**mak - Sk**min</td>
                <td><input type="text" name="r_sk_diff" value=""></td>
            </tr>
            <tr>
                <td>Q/n<sup>0.5</sup></td>
                <td><input type="text" name="q_over_n" value=""></td>
                <td> dengan probabilitas 95% dari tabel</td>
                <td><input type="text"></td>
                <td style="background-color: yellow;"><input type="text" style="background-color: yellow;"></td>
            </tr>
            <tr>
                <td>R/n<sup>0.5</sup></td>
                <td><input type="text" name="r_over_n" value=""></td>
                <td> dengan probabilitas 95% dari tabel</td>
                <td><input type="text"></td>
                <td style="background-color: yellow;"><input type="text" style="background-color: yellow;"></td>
            </tr>
        </table>

        <br><br>

        <div class="flex-item">
            <h2>Nilai Q/n<sup>0.5</sup> dan R/n<sup>0.5</sup></h2>
            <table>
                <tr>
                    <th rowspan="2">n</th>
                    <th colspan="3">Q/n<sup>0.5</sup></th>
                    <th colspan="3">R/n<sup>0.5</sup></th>
                </tr>
                <tr>
                    <th>90%</th>
                    <th>95%</th>
                    <th>99%</th>
                    <th>90%</th>
                    <th>95%</th>
                    <th>99%</th>
                </tr>
                <tr>
                    <td>10</td>
                    <td>1,05</td>
                    <td>1,14</td>
                    <td>1,29</td>
                    <td>1,21</td>
                    <td>1,28</td>
                    <td>1,38</td>
                </tr>
                <tr>
                    <td>20</td>
                    <td>1,1</td>
                    <td>1,22</td>
                    <td>1,42</td>
                    <td>1,34</td>
                    <td>1,43</td>
                    <td>1,6</td>
                </tr>
                <tr>
                    <td>30</td>
                    <td>1,12</td>
                    <td>1,24</td>
                    <td>1,48</td>
                    <td>1,4</td>
                    <td>1,5</td>
                    <td>1,7</td>
                </tr>
                <tr>
                    <td>40</td>
                    <td>1,14</td>
                    <td>1,27</td>
                    <td>1,52</td>
                    <td>1,44</td>
                    <td>1,55</td>
                    <td>1,78</td>
                </tr>
                <tr>
                    <td>100</td>
                    <td>1,17</td>
                    <td>1,32</td>
                    <td>1,63</td>
                    <td>1,62</td>
                    <td>1,75</td>
                    <td>2</td>
                </tr>
                <tr>
                    <td>12</td>
                    <td>1,05</td>
                    <td>1,14</td>
                    <td>1,29</td>
                    <td>1,21</td>
                    <td>1,28</td>
                    <td>1,38</td>
                </tr>
            </table>
            <p>Sumber: Sri Harto, 1993: 168</p>
        </div>

        
        <input type="submit" value="Submit">
    </form>
    
    <script>
        function calculateTotals(month) {
            let total = 0;
            let max = 0;
            let periode1 = 0;
            let periode2 = 0;
            let periode3 = 0;
    
            for (let day = 1; day <= 31; day++) {
                const input = document.querySelector(`input[name="day${day}_month${month}"]`);
                if (input && !isNaN(parseFloat(input.value))) {
                    const value = parseFloat(input.value) || 0;
                    total += value;
                    if (value > max) {
                        max = value;
                    }
                    if (day <= 10) {
                        periode1 += value;
                    } else if (day >= 11 && day <= 20) {
                        periode2 += value;
                    } else if (day >= 21 && day <= 30) {
                        periode3 += value;
                    }
                }
            }
            document.getElementById(`total_month${month}`).value = total;
            document.getElementById(`maksimum_month${month}`).value = max;
            document.getElementById(`periode1_month${month}`).value = periode1;
            document.getElementById(`periode2_month${month}`).value = periode2;
            document.getElementById(`periode3_month${month}`).value = periode3;
    
            document.getElementById(`curah_hujan_${month - 1}`).value = total;
    
            // Recalculate the total, average, maximum, minimum, Sk*, Sk* Brackets, and Rerata Sk* Brackets
            calculateCurahHujanTotal();
        }
    
        function calculateCurahHujanTotal() {
            let jumlahCurahHujan = 0;
            let count = 0;
            let maxCurahHujan = 0;
            let minCurahHujan = Infinity;
    
            for (let i = 0; i < 12; i++) {
                const curahHujanValue = parseFloat(document.getElementById(`curah_hujan_${i}`).value) || 0;
                jumlahCurahHujan += curahHujanValue;
                if (curahHujanValue > 0) {
                    count++;
                }
                if (curahHujanValue > maxCurahHujan) {
                    maxCurahHujan = curahHujanValue;
                }
                if (curahHujanValue < minCurahHujan && curahHujanValue > 0) {
                    minCurahHujan = curahHujanValue;
                }
            }
    
            // Calculate average
            const rerataCurahHujan = count > 0 ? (jumlahCurahHujan / count).toFixed(2) : 0;
    
            // If no valid minimum value was found, set it to 0
            if (minCurahHujan === Infinity) {
                minCurahHujan = 0;
            }
    
            // Set the values in the respective fields
            document.getElementById('jumlah_curah_hujan').value = jumlahCurahHujan;
            document.getElementById('rerata_curah_hujan').value = rerataCurahHujan;
            document.getElementById('maks_curah_hujan').value = maxCurahHujan;
            document.getElementById('min_curah_hujan').value = minCurahHujan;
    
            // Calculate Sk* and Sk* Brackets for each month, then calculate the average Sk* Brackets
            calculateSk(rerataCurahHujan);
        }
    
        function calculateSk(rerata) {
            let totalSkBrackets = 0;
            let count = 0;
    
            for (let i = 0; i < 12; i++) {
                const curahHujanValue = parseFloat(document.getElementById(`curah_hujan_${i}`).value) || 0;
                const skValue = (curahHujanValue - rerata).toFixed(2);
                document.getElementById(`sk_${i}`).value = skValue;
    
                // Calculate the absolute value for sk_brackets
                const skBracketsValue = Math.abs(skValue).toFixed(2);
                document.getElementById(`sk_brackets_${i}`).value = skBracketsValue;
                
                // Calculate Dy^2
                const nValue = parseFloat(document.getElementById('n').value) || 12; // Default to 12 if not set
                const dy2Value = ((skBracketsValue ** 2) / nValue).toFixed(2);
                document.getElementById(`dy2_${i}`).value = dy2Value;

                // Sum the Sk* Brackets values for average calculation
                totalSkBrackets += parseFloat(skBracketsValue);
                count++;
            }
    
            // Calculate the average Sk* Brackets
            const rerataSkBrackets = count > 0 ? (totalSkBrackets / count).toFixed(2) : 0;
            document.getElementById('rerata_sk_brackets').value = rerataSkBrackets;

            // Calculate the sum of all dy2 values
            calculateDy2Sum();            
        }

        function calculateDy2Sum() {
            let sumDy2 = 0;

            for (let i = 0; i < 12; i++) {
                const dy2Value = parseFloat(document.getElementById(`dy2_${i}`).value) || 0;
                sumDy2 += dy2Value;
            }

            document.getElementsByName('jumlah_dy2')[0].value = sumDy2.toFixed(2);
        }
        

    </script>
    
</body>
</html>
